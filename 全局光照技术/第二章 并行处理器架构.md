# 第二章 并行处理器架构

## 2.1 CPU 应用程序执行模型

### 各种存储设备的读取时间

- 寄存器：1 个 CPU 时钟周期
- 一级缓存：3 个 CPU 时钟周期
- 二级缓存：30+ 个 CPU 时钟周期
- 内存：220+ 个 CPU 时钟周期

### 缓存机制利用的时间和空间的局部性原

## 2.1.2 预取

编写高性能的代码的时候需要考虑指令的连续性，这样能够大大提高程序运行的性能。

## 2.2 并行架构

### 2.2.1 指令级并行

### 2.2.2 线程级并行

### 2.2.3 处理器级并行

## 2.3 GPU 并行计算架构

### GPU 和 CPU 一起形成一个非对等的多处理器架构，开发者需要通过 CPU 来调度和管理 GPU 的运行。

### 2.3.1 为什么需要一个并行计算的架构

使用一般的多处理器架构执行大规模的并行计算的限制来自针对串行计算优化的缓存系统，由于处理器时钟和主内存的读取速度之间的巨大差异导致数据读取的巨大延迟，缓存系统通过充分利用局部性原理预取指令和数据，大大减少对数据读取导致的延迟，以保证串行程序的高效执行。高速缓存系统成本高，传输数据非常消耗电能，这些因素使得基于缓存的处理器系统难以支持大规模的并行计算。所以这也是产生了 GPU 的并行计算架构的原因

### 2.3.2 内存结构

- 寄存器 约 8TB/s 1个周期
- 共享内存 约 1.5TB/s 1-32个周期
- 纹理/常量内存 约 200MB/s 400-600 个周期
- 全局内存 约 200MB/s 400-600 个周期

#### 2.3.2.1 全局内存

- 是 GPU 中读取最慢的内存
- 通过 PCI-E 3.0 全双工总线与处理器相连
- 传输速度是单向 8GB/s
- 尽量减少全局内存的读写以提供性能
- 使用流传输的模型来使数据传输和内核函数的执行重叠减少相应的延迟

#### 2.3.2.2 常量、纹理内存

- 可以被多个线程同时访问的数据
- 可以被多个线程随机访问的数据
- 常量内存和纹理内存只是全局内存的一种虚拟地址形式，GPU 没有特殊的保留的常量和纹理内存，但是常量和纹理内存能够提供高速的缓存。
- 常量内存和纹理内存都是只读内存
- 纹理内存提供硬件的线性差值



